(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{300:(e,t,s)=>{"use strict";s.d(t,{r:()=>i});var r=s(4232),a=s(5051),n=s(4723),l=s(7526);let i=()=>{let{instance:e,accounts:t}=(0,a.dk)(),[s,i]=(0,r.useState)(null),[c,o]=(0,r.useState)(!0),[d,h]=(0,r.useState)(null),m=async t=>{try{var s;let r=await e.acquireTokenSilent({scopes:n.$.scopes,account:t}),a=r.idTokenClaims,l={email:(null===(s=a.emails)||void 0===s?void 0:s[0])||a.email||a.preferred_username||"",name:a.name||"".concat(a.given_name||""," ").concat(a.family_name||"").trim()||"Unknown User",idTokenClaims:a,idToken:r.idToken,accessToken:r.accessToken};i(l)}catch(t){if(t instanceof l.CB)try{await e.loginRedirect(n.$)}catch(e){h("Login required: "+e)}else h("Failed to acquire token: "+t)}};return(0,r.useEffect)(()=>{(async()=>{try{let s;await e.initialize(),await e.handleRedirectPromise()?s=e.getAllAccounts()[0]:t.length>0&&(s=t[0]),s&&await m(s)}catch(e){h("MSAL initialization error: "+e)}finally{o(!1)}})()},[e]),{userData:s,loading:c,error:d}}},378:(e,t,s)=>{"use strict";s.d(t,{A:()=>u});var r=s(7876),a=s(7328),n=s.n(a),l=s(8230),i=s.n(l),c=s(9099);let o=[{label:"Utfordringer",href:"/challenges"},{label:"Team",href:"/team"},{label:"Ledertavle",href:"/leaderboard"}],d=()=>{let e=(0,c.useRouter)();return(0,r.jsx)("div",{className:"fixed top-0 left-0 z-20 w-full bg-zinc-900 pt-safe",children:(0,r.jsx)("header",{className:"border-b bg-zinc-100 px-safe dark:border-zinc-800 dark:bg-zinc-900",children:(0,r.jsxs)("div",{className:"mx-auto flex h-20 max-w-screen-md items-center justify-between px-6",children:[(0,r.jsx)(i(),{href:"/",children:(0,r.jsx)("h1",{className:"font-medium",children:"Bouvet app"})}),(0,r.jsxs)("nav",{className:"flex items-center space-x-6",children:[(0,r.jsx)("div",{className:"hidden sm:block",children:(0,r.jsx)("div",{className:"flex items-center space-x-6",children:o.map(t=>{let{label:s,href:a}=t;return(0,r.jsx)(i(),{href:a,className:"text-sm ".concat(e.pathname===a?"text-indigo-500 dark:text-indigo-400":"text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-zinc-50"),children:s},s)})})}),(0,r.jsx)("div",{title:"Gluten Free",onClick:()=>e.push("./profile"),className:"h-10 w-10 rounded-full bg-zinc-200 bg-cover bg-center shadow-inner dark:bg-zinc-800",style:{backgroundImage:"url(https://images.unsplash.com/photo-1612480797665-c96d261eae09?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80)"}})]})]})})})},h=()=>{let e=(0,c.useRouter)();return(0,r.jsx)("div",{className:"sm:hidden",children:(0,r.jsx)("nav",{className:"fixed bottom-0 w-full border-t bg-zinc-100 pb-safe dark:border-zinc-800 dark:bg-zinc-900",children:(0,r.jsx)("div",{className:"mx-auto flex h-16 max-w-md items-center justify-around px-6",children:m.map(t=>{let{href:s,label:a,icon:n}=t;return(0,r.jsxs)(i(),{href:s,className:"flex h-full w-full flex-col items-center justify-center space-y-1 ".concat(e.pathname===s?"text-indigo-500 dark:text-indigo-400":"text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-zinc-50"),children:[n,(0,r.jsx)("span",{className:"text-xs text-zinc-600 dark:text-zinc-400",children:a})]},a)})})})})},m=[{label:"Home",href:"/",icon:(0,r.jsx)("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",children:(0,r.jsx)("path",{d:"M7.5.5l.325-.38a.5.5 0 00-.65 0L7.5.5zm-7 6l-.325-.38L0 6.27v.23h.5zm5 8v.5a.5.5 0 00.5-.5h-.5zm4 0H9a.5.5 0 00.5.5v-.5zm5-8h.5v-.23l-.175-.15-.325.38zM1.5 15h4v-1h-4v1zm13.325-8.88l-7-6-.65.76 7 6 .65-.76zm-7.65-6l-7 6 .65.76 7-6-.65-.76zM6 14.5v-3H5v3h1zm3-3v3h1v-3H9zm.5 3.5h4v-1h-4v1zm5.5-1.5v-7h-1v7h1zm-15-7v7h1v-7H0zM7.5 10A1.5 1.5 0 019 11.5h1A2.5 2.5 0 007.5 9v1zm0-1A2.5 2.5 0 005 11.5h1A1.5 1.5 0 017.5 10V9zm6 6a1.5 1.5 0 001.5-1.5h-1a.5.5 0 01-.5.5v1zm-12-1a.5.5 0 01-.5-.5H0A1.5 1.5 0 001.5 15v-1z",fill:"currentColor"})})},{label:"Challenges",href:"/challenges",icon:(0,r.jsx)("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",children:(0,r.jsx)("path",{d:"M2.5.5V0H2v.5h.5zm10 0h.5V0h-.5v.5zM4.947 4.724a.5.5 0 00-.894-.448l.894.448zM2.5 8.494l-.447-.223-.146.293.21.251.383-.32zm5 5.997l-.384.32a.5.5 0 00.769 0l-.385-.32zm5-5.996l.384.32.21-.251-.146-.293-.447.224zm-1.553-4.219a.5.5 0 00-.894.448l.894-.448zM8 9.494v-.5H7v.5h1zm-.5-4.497A4.498 4.498 0 013 .5H2a5.498 5.498 0 005.5 5.497v-1zM2.5 1h10V0h-10v1zM12 .5a4.498 4.498 0 01-4.5 4.497v1c3.038 0 5.5-2.46 5.5-5.497h-1zM4.053 4.276l-2 3.995.895.448 2-3.995-.895-.448zM2.116 8.815l5 5.996.769-.64-5-5.996-.769.64zm5.768 5.996l5-5.996-.768-.64-5 5.996.769.64zm5.064-6.54l-2-3.995-.895.448 2 3.995.895-.448zM8 14.49V9.494H7v4.997h1z",fill:"currentColor"})})},{label:"Lag",href:"/team",icon:(0,r.jsx)("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",children:(0,r.jsx)("path",{d:"M7.5 15V7m0 .5v3m0-3a4 4 0 00-4-4h-3v3a4 4 0 004 4h3m0-3h3a4 4 0 004-4v-3h-3a4 4 0 00-4 4v3zm0 0l4-4m-4 7l-4-4",stroke:"currentColor"})})},{label:"Ledertavle",href:"/leaderboard",icon:(0,r.jsx)("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",children:(0,r.jsx)("path",{d:"M7.5 15V7m0 .5v3m0-3a4 4 0 00-4-4h-3v3a4 4 0 004 4h3m0-3h3a4 4 0 004-4v-3h-3a4 4 0 00-4 4v3zm0 0l4-4m-4 7l-4-4",stroke:"currentColor"})})}],u=e=>{let{title:t,children:s}=e;return(0,r.jsxs)(r.Fragment,{children:[t?(0,r.jsx)(n(),{children:(0,r.jsxs)("title",{children:["Rice Bowl | ",t]})}):null,(0,r.jsx)(d,{}),(0,r.jsx)("main",{className:"mx-auto max-w-screen-md pt-20 pb-16 px-safe sm:pb-0",children:(0,r.jsx)("div",{className:"p-6",children:s})}),(0,r.jsx)(h,{})]})}},980:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(7876);let a=e=>{let{children:t}=e;return(0,r.jsx)("section",{className:"mt-10",children:t})}},6760:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(7554)}])},7554:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var r=s(7876),a=s(378),n=s(980),l=s(4232);let i=e=>{let{cities:t,citySelection:s}=e;return(0,r.jsx)("div",{className:"absolute mt-2 w-48 bg-white rounded-md shadow-lg z-10",children:t.map((e,t)=>(0,r.jsx)("p",{onClick:()=>s(e),className:"cursor-pointer px-4 py-2 text-gray-700 hover:bg-indigo-600 hover:text-white",children:e},t))})},c=e=>{let{selectedMethod:t,onSelectMethod:s}=e,[a,n]=(0,l.useState)(!1);return(0,r.jsxs)("div",{className:"relative inline-block text-left",children:[(0,r.jsx)("button",{type:"button",onClick:()=>n(e=>!e),className:"inline-flex justify-between w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:(0,r.jsx)("span",{children:t?"Select: ".concat(t):"Select ..."})}),a&&(0,r.jsx)(i,{cities:["car","bus","cycling","walking"],citySelection:e=>{s(e),n(!1)}})]})};var o=s(300);let d=()=>{let[e,t]=(0,l.useState)(""),[s,a]=(0,l.useState)(!1),[n,i]=(0,l.useState)(null),[d,h]=(0,l.useState)(null),{userData:m}=(0,o.r)(),u={car:100,bus:200,cycling:300,walking:400},x=async t=>{if(t.preventDefault(),a(!0),i(null),h(null),!e){i("Please select a driving method."),a(!1);return}if(!m||!m.email){i("User is not authenticated."),a(!1);return}try{let t={email:m.email,method:e,points:u[e]};console.log("Sending payload:",JSON.stringify(t));let s=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/TransportEntry/upsert",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m.accessToken)},body:JSON.stringify(t)});if(!s.ok)throw Error("HTTP error! Status: ".concat(s.status));let r=await s.json();console.log("Response received:",r),h("Driving method submitted successfully!")}catch(e){console.error("Error submitting data:",e),i(e.message||"Something went wrong")}finally{a(!1)}};return(0,r.jsxs)("form",{onSubmit:x,className:"max-w-sm mx-auto p-4",children:[(0,r.jsx)(c,{selectedMethod:e,onSelectMethod:t}),(0,r.jsx)("button",{type:"submit",disabled:!e||s,className:"mt-4 inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-sm font-medium text-white hover:bg-indigo-700",children:s?"Submitting...":"Submit"}),n&&(0,r.jsx)("p",{className:"mt-2 text-red-500",children:n}),d&&(0,r.jsx)("p",{className:"mt-2 text-green-500",children:d})]})};var h=s(5051),m=s(4723);let u=()=>{let{instance:e,inProgress:t}=(0,h.dk)(),[s,a]=(0,l.useState)(!1),n=async()=>{a(!0);try{await e.loginRedirect({...m.$,prompt:"login"})}catch(e){console.error("Error in login flow:",e)}finally{a(!1)}};return(0,r.jsx)("div",{children:(0,r.jsx)("button",{onClick:n,disabled:s||"none"!==t,children:s||"none"!==t?"Signing in...":"Sign In"})})},x=()=>{let{instance:e}=(0,h.dk)();return(0,r.jsx)("button",{onClick:()=>{sessionStorage.removeItem("userUpserted"),e.logoutRedirect()},children:"Sign Out"})},v=()=>{let{userData:e,loading:t}=(0,o.r)();return(0,l.useEffect)(()=>{let s=async()=>{if(e&&!sessionStorage.getItem("userUpserted"))try{var t;let s=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/users/upsert",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:JSON.stringify({email:e.email,name:e.name,azureId:null===(t=e.idTokenClaims)||void 0===t?void 0:t.sub,companyId:1,TotalScore:100})});s.ok?(console.log("User upserted successfully"),sessionStorage.setItem("userUpserted","true")):console.error("User upsert failed:",await s.text())}catch(e){console.error("Error during user upsert:",e)}};!t&&e&&s()},[t,e]),null},g=()=>(0,r.jsx)(a.A,{children:(0,r.jsxs)(n.A,{children:[(0,r.jsx)("div",{className:"app mt-4",children:(0,r.jsx)(d,{})}),(0,r.jsx)(h.hj,{children:(0,r.jsxs)("h1",{children:[(0,r.jsx)(u,{})," Ikke logget inn!"]})}),(0,r.jsxs)(h.e7,{children:[(0,r.jsx)("h1",{children:"Logged in"}),(0,r.jsx)(x,{}),(0,r.jsx)(v,{})]})]})})}},e=>{var t=t=>e(e.s=t);e.O(0,[305,636,593,792],()=>t(6760)),_N_E=e.O()}]);